---
layout: project
permalink: /:title/
category: projects

meta:
  keywords: "unitree"

project:
  title: "Hacking Unitree Cameras"
  type: "Jekyll"
  url: "https://github.com/katie-hughes/UnitreecameraSDK/tree/main"
  logo: "/assets/images/projects/unitree/disassembled_crop.jpg"
  tech: "Unitree, strace, GDB"

---

This post (still in progress) details efforts to completely eliminate the use of the UnitreeCameraSDK to stream from the onboard cameras on the Unitree Go1 robot. The goal was to completely replace the Jetson Nanos on the robot with fresh copies that don't contain any Unitree software. I was able to pinpoint the exact syscall at which the cameras are enabled through their camera SDK using `strace` and `gdb`. It is an `ioctl` call of the following format:
```
ioctl(5, UVCIOC_CTRL_QUERY, &query)
```
5 is a file descriptor referring to `/dev/video0`, the streaming device about to be unlocked. 
`query` is a struct of type `uvc_xu_control_query`, defined in `/usr/include/linux/uvcvideo.h`.
`query.unit = 3`,
`query.selector = 5`,
`query.query = 1`, and
`query.size = 64`.

## Details to replicate
My standard way of testing the cameras was through the linux `ffmpeg` command. If you disable the autostart folder on the Jetson Nanos, then run the following command, you should see the following error message.
```
$ ffmpeg -i /dev/video0 output0.mp4
...
could not find codec parameters for stream 0 (Video: mjpeg, none(bt470bg/unknown/unknown), 1856s800): unspecified pixel format
```
Any other attempts to read from the cameras will similarly fail with no data being encoded.

<br>


<br><br>

